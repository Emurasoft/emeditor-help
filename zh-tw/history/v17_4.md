# Version 17.4

2018年1月17日

## 一般新增功能

- 添加了更多選項到「僅搜索選區」的規則運算式搜索中。 例如，啟用'^'和'$'可以符合選取部分的開始和結束 選項允許你使用僅符合選區開始/結束部分的規則運算式。 啟用在僅搜索選區時用環顧 選項讓你能使用右合/左合樣式在僅搜索選區時檢視選區外部。
- 在 CSV 儲存格選擇模式中添加了更多選項，這些選項允許你在編輯時保留相同數量的欄，或者在外部雙擊以創建新的儲存格。
- Boost.Regex 版本更新到 v1.66.0。
- 將對話方塊中的字型大小從 9pt 恢復為 8pt，除了中文。
- 優化了高 DPI 螢幕的圖示。
- 針對 Windows 7 或更高版本進行了優化。可執行檔案的數位簽章僅使用 SHA256 證書，以前的帶 SHA1 證書的雙重簽名已被棄用。 此版本不支持 Windows Vista / Server 2008。
- 為了防止防病毒軟件錯誤警報，安裝的檔案副檔名從 .exe 更改為 .msi。
- 大大提高了執行全部取代（當尋找字串包含換行字元而取代字串不包含時）以及其復原操作的速度。 參見下面的測試結果表。

### 測試結果:

|  | v16.5 | v16.6 | v16.9 | v17.4 | 與 v16.5 相較 |
| --- | --- | --- | --- | --- | --- |
| 把 「9\\n」 全部取代為 「a」 | 32.7 秒 | 22.4 秒 | 0.17 秒 | 0.141 秒 | 快 232 倍 |
| 復原上述操作 | 73.5 秒 | 29.2 秒 | 27.8 秒 | 6.89 秒 | 快 10.7 倍 |

\\* 所有測試條件與 [Version 16.6](v16_6) 中一樣。

## 新增選項

- 添加了'^'和'$'可以符合選取部分的開始和結束 和在僅搜索選區時用環顧 核取方塊到 [進階（尋找） 對話方塊](../dlg/advanced/index) 中。
- 添加了當超長行存在時提示 核取方塊到自訂 對話方塊的 [編輯 頁面](../dlg/customize/edit/index) 上。
- 添加了在儲存格選擇模式下編輯時保持欄數相同，按 TAB 鍵在儲存格選擇模式下創建一個新的儲存格，雙擊標題/行號在儲存格選擇模式下創建一個新的欄/行，和雙擊外部以在儲存格選擇模式下創建新儲存格 核取方塊到自訂 對話方塊的 [CSV 頁面](../dlg/customize/csv/index) 上。
- 添加了更多規則運算式範例到尋找/取代 對話方塊中點擊> 按鈕顯示的功能表上。

## 外掛程式新增功能

-字數統計 外掛程式現在使用自訂 對話方塊 [編輯 頁面](../dlg/customize/edit/index) 上將以下字元識別為英數字元 文字方塊中指定的字元作為單字的組成部分。 例如，在這個文字方塊中指定縮寫符號（'）會導致字數統計外掛程式把 _I'm_ 計為一個單字，與狀態列中顯示的單字數一致。

## 外掛程式 API 新增功能

- 添加了FLAG\_FIND\_BOL，FLAG\_FIND\_EOL，和FLAG\_FIND\_LOOKAROUND 常量到 [FIND\_REPLACE\_INFO 結構](../plugin/structure/find_replace_info) 的 _nFlags_ 成員中。

## 新增巨集功能

- 添加了eeExFindBOL，eeExFindEOL，和eeExFindLookaround 常量到Selection 對象的 [Find 方法](../macro/selection/selection_find) 以及 [Replace 方法](../macro/selection/selection_replace) 的 _nExFlags_ 參數中。

## 修復 Bug

- 修復了從一個非常大的檔案中刪除所有換行符號時可能會崩潰的錯誤。
- 修復了與編輯非常大的檔案相關的各種問題。 例如，對包含雙位元字元的大檔案執行一系列特定操作之後，游標位置可能不正確。
- 修正了某些規則運算式的搜索和取代。 例如，在「僅搜索選區」的搜索中，在「尋找」對話方塊中單擊「尋找前一個」按鈕時，規則運算式「^ a +」可能會符合不正確的位置。
