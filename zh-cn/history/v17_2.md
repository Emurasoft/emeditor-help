# Version 17.2

2017年10月18日

## 一般新增功能

- 在 CSV 单元格选择模式中添加了自动填充 功能。 自动填充功能允许你拖动所选单元格边框（自动填充句柄）的右下角，将与选定单元格相同的值复制到上，下，右或左相邻的单元格中。 如果选择了多个单元格，并且这些单元格包含序号，则可以通过拖动自动填充句柄 轻松扩展这些值。 当所选单元格位于 CSV 文档的顶部时，双击自动填充句柄，上述行为可应用于文档的整个列。
- 添加了快速填充 命令。在 CSV 单元格选择模式下选择快速填充命令会使 EmEditor 将当前单元格与其他列进行比较，如果找到明显的模式，则使用数据填充当前列。
- 添加了「快速填充」 和「验证 CSV」 按钮到CSV/排序 工具栏上。
- 无论垂直滚动条上的标记是否可见，右键单击垂直滚动条所显示的上下文菜单变得相同；另外，添加了显示标记 命令到菜单中。
- 当使用“删除行末空格” 命令时，新版本不会删除当前光标行中的空格。
- 新版本会在有列标题的对话框中反映列标题类型 的选项。
- 当双击一个单元格时，新版本会调整初始光标位置。
- 双击 CSV 标题或标尺的右侧可以添加列，双击行号的底部可以在 CSV 文档中添加一行。
- 单击启动 窗口中的文件夹可以从该文件夹中打开。
-Sum.jsee 宏支持 CSV 文档。
- 提高了全部替换和批次替换的速度。

### 测试结果：

|  | v17.1 | v17.2 | 比较 |
| --- | --- | --- | --- |
| 批次替换 | 32.8 秒 | 16.1 秒 | 快 2 倍 |

\\* 40MB (736,831 行) UTF-8 文件，一批 500 次替换。

## 新增选项

- 添加了搜索 文本框到配置属性的 [显示 页面](../dlg/properties/display/index) 上。
- 添加了启用自动填充 复选框到自定义 对话框的 [CSV 页面](../dlg/customize/csv/index) 上。
- 添加了 [自动填充 对话框](../dlg/auto_fill/index)。

## 新增命令

- [切换垂直滚动条上的标记](../cmd/window/scroll_marks_toggle)
- [验证 CSV](../cmd/edit/csv_validate)
- [使列数相同](../cmd/edit/make_columns_same)
- [自动填充](../cmd/edit/auto_fill)
- [快速填充](../cmd/edit/flash_fill)

## 插件 API 新增特性

- 添加了EI\_VALIDATE\_CSV 和EI\_GET\_CLIENT\_RECT\_NO\_BARS 命令到 [EE\_INFO 消息](../plugin/message/ee_info) 中。

## 新增宏功能

- 添加了 [ValidateCsv 方法](../macro/document/validatecsv) 到 [Document 对象](../macro/document/index) 中。

## 修复 Bug

- 修复了某个与宏快捷键相关的问题。
- 修复了当执行宏 "document.Config.Save();" 时，大纲设定会重设为默认的问题。
- 修复了排序 命令会导致 EmEditor 故障的问题。
- 修复了某个与单词自动完成 插件相关的问题。
