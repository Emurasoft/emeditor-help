# Version 22.5

2023年7月25日

## 一般新增功能

- 如果在配置属性对话框的 [**语言服务器** 页面](../dlg/properties/language_server/index) 上勾选了 **启用语言服务器协议**，则 **搜索符号** 功能会使用语言服务器协议。\[P\]
- 添加了 JSON 语言服务器。\[P\]
- 新版本允许您单击行号的左边缘来切换书签。
- 新版本优化了外部文件更改检查。
- 即使当前行为空，也能启用注释命令。
- 默认情况下，打开大文件时不会显示 **大文件控制器**。取而代之，将显示一个工具提示，单击工具提示才会显示 **大文件控制器**。您可以在 **自定义** 对话框的 [**文件** 页面](../dlg/customize/file/index) 中更改此默认行为。
- 如果 32 位版本在64 位 Windows 上运行，新版本在启动 EmEditor 时会显示提示消息框。
- 当互联网连接可用时，添加了对注册密钥的许可证验证检查。
- 提高了各种命令的速度。

### 测试结果：

|  | v22.4 | v22.5 | 比较 |
| --- | --- | --- | --- |
| 删除重复行 \[\*A\] | 5.900 秒 | 5.535 秒 | 快 1.07 倍 |
| 全选，复制 \[\*A\] | 1.765 秒 | 1.186 秒 | 快 1.49 倍 |
| 筛选，提取匹配字符串 \[\*A\] | 3.610 秒 | 2.238 秒 | 快 1.61 倍 |
| 字数（状态栏） \[\*A\] | 0.914 秒 | 0.271 秒 | 快 3.37 倍 |
| 查找下一个警告字符 \[\*B\] | 1.227 秒 | 0.466 秒 | 快 2.63 倍 |
| 总和（状态栏） \[\*C\] | 0.269 秒 | 0.217 秒 | 快 1.24 倍 |
| CSV 语法检查 \[\*C\] | 0.234 秒 | 0.095 秒 | 快 2.46 倍 |

\*A：1.34 GB，1 亿行，随机 ASCII 文本文件。

\*B：9.49 GB，1 亿行，随机 ASCII 文本文件。

\*C：1.99 GB，1590 万行，随机 ASCII CSV 文件。

全选、复制的宏：document.selection.SelectAll(); document.selection.Copy(eeCopyUnicode);

全部：除了选择“总是丢弃过长的撤销信息来加速”之外都是默认选项；Windows 11，Core i7-13700，80 GB RAM。

## 新增选项

- 从配置属性的 [**文件** 页面](../dlg/properties/file/index) 上移除了 **监控时间间隔\[秒\]** 文本框。
- 添加了 **JSON** 到配置属性的 **语言服务器** 页面上的 **文档类型** 下拉列表框中。 {{pro}}
- 添加了 **垂直标记 \- 书签 (悬停)** 到配置属性对话框中 [**显示** 页面](../dlg/properties/display/index) 上的 **指定部分** 列表框中。

## 新增插件功能 {{pro}}

- 为 [**CommitList**](../howto/plugin/plugin_commit_list) 插件中的 **拉取** 和 **推送** 按钮添加了提前/滞后提交的标记。

## 新增宏功能 {{pro}}

- 添加了 [**Stderr** 方法](../macro/editor/stderr) 到 **Editor** 对象中。

### 备注

- \[P\] 仅限 EmEditor 专业版
