{% extends "basic/layout.html" %}

{%- block scripts %}
    {{- script() }}
    <meta name="EmEditor documentation">

    <link rel="preconnect" href="https://fonts.googleapis.com" referrerpolicy="no-referrer">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin referrerpolicy="no-referrer">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,600,0,0" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto&family=Roboto+Mono&display=swap" referrerpolicy="no-referrer">

    <script src="{{ pathto('_static/js/theme.js', 1) }}"></script>
    <script src="{{ pathto('_static/js/petite-vue.js', 1) }}"></script>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // Replace <pro /> and <profree /> tags
            const proTitle = `
                {% if language == "en" %}
                    EmEditor Professional only
                {% elif language == "ja" %}
                    EmEditor Professional のみ
                {% elif language == "ko" %}
                {% elif language == "zh-CN" %}
                    仅限 EmEditor 专业版
                {% elif language == "zh-TW" %}
                    僅限 EmEditor 專業版
                {% endif %}
            `;
            const proFreeTitle = `
                {% if language == "en" %}
                    EmEditor Professional and EmEditor Free
                {% elif language == "ja" %}
                    EmEditor Professional と EmEditor Free
                {% elif language == "ko" %}
                {% elif language == "zh-CN" %}
                    仅限 EmEditor 专业版
                {% elif language == "zh-TW" %}
                    EmEditor 專業版和 EmEditor 免費版
                {% endif %}
            `;

            for (const element of document.querySelectorAll("pro")) {
                element.textContent = "[P]";
                element.setAttribute("title", proTitle.trim());
                element.style.verticalAlign = "super";
                element.style.fontSize = "smaller";
                element.style.cursor = "help";
            }

            for (const element of document.querySelectorAll("profree")) {
                element.textContent = "[PF]";
                element.setAttribute("title", proFreeTitle.trim());
                element.style.verticalAlign = "super";
                element.style.fontSize = "smaller";
                element.style.cursor = "help";
            }

            // Scroll sidebar to current page
            // Last item in array is current item
            const itemElements = document.querySelectorAll("li.current");
            if (itemElements.length > 0) {
                // Scroll to first child in item
                let focusElement = itemElements[itemElements.length - 1];
                if (focusElement.firstChild) {
                    focusElement = focusElement.firstChild;
                }

                focusElement.scrollIntoView({block: "center"});
            }

            // Hide empty table header
            for (const element of document.querySelectorAll("th.head")) {
                if (element.innerText === "") {
                    element.style.display = "none";
                }
            }

            // External links
            for (const element of document.querySelectorAll("a.external")) {
                element.setAttribute("target", "_blank");
            }
        });
    </script>
{% endblock %}

{%- block body_tag %}
    <body data-dark_mode_code_blocks="{{ 'true' if theme_dark_mode_code_blocks else 'false' }}">
{% endblock %}

{%- block header %}

<div id="top_nav">
    {% if theme_banner_text and theme_banner_text != 'false' %}
        {% include "./components/notification_banner.html" %}
    {% endif %}

    <nav>
        {% if logo_url %}
            {% set nav_title = '<img src="' + logo_url + '"/>' %}
        {% else %}
            {% set nav_title = shorttitle %}
        {% endif %}

        <p id="toggle_sidebar">
            <a href="#" title="Toggle sidebar">|||</a>
        </p>
        <h1><a href="{{ pathto(root_doc)|e }}" title="Go to homepage">{{ nav_title }}</a></h1>

        <div class="languageDropdown">
            <a href="#" onclick="toggleLanguageDropdown()">
                {% if language == "en" %}
                    English
                {% elif language == "ja" %}
                    日本語
                {% elif language == "ko" %}
                    한국어
                {% elif language == "zh-CN" %}
                    简体中文
                {% elif language == "zh-TW" %}
                    繁體中文
                {% endif %}
            </a>
            <div class="languageDropdown-content">
                <a href="#" onclick="changeLanguage('en')">English</a>
                <a href="#" onclick="changeLanguage('ja')">日本語</a>
                <a href="#" onclick="changeLanguage('ko')">한국어</a>
                <a href="#" onclick="changeLanguage('zh-cn')">简体中文</a>
                <a href="#" onclick="changeLanguage('zh-tw')">繁體中文</a>
            </div>

            <script>
                function changeLanguage(lang) {
                    const currentLevel = ('{{ pagename }}'.match(/\//g)||[]).length + 1;
                    const newPath = '../'.repeat(currentLevel) + lang + '/{{ pagename }}.html';
                    window.location.href = newPath;
                }
            </script>
        </div>

        &nbsp;&nbsp;&nbsp;&nbsp;

        {%- if theme_source_url %}
            {% include "./components/source_link.html" %}
        {% endif %}

        {% include "./components/dark_mode_toggle.html" %}

        {%- if pagename != "search" %}
            <p class="mobile_search_link">
                <a href="{{ pathto('search') }}" title="Search">
                    <span class="material-symbols-outlined" style="font-size:1.2em;">
                        search
                    </span>
                </a>
            </p>
        {% endif %}

        <div class="searchbox_wrapper">
            {%- if pagename != "search" and builder != "singlehtml" %}
                <div id="searchbox" style="display: none" role="search">
                <h3 id="searchlabel">{{ _('Quick search') }}</h3>
                    <div class="searchformwrapper">
                        <form class="search" action="{{ pathto('search') }}" method="get">
                            <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="{% if language == "en" %}Search{% elif language == "ja" %}検索{% elif language == "ko" %}이동{% elif language == "zh_CN" %}提交{% elif language == "zh_TW" %}前往{% endif %}" />
                            <button class="material-symbols-outlined" style="font-size:1.2em;">
                                search
                            </button>
                        </form>
                    </div>
                </div>
                <script>document.getElementById('searchbox').style.display = "block"</script>
            {%- endif %}
        </div>
    </nav>
</div>

<script>
    function toggleLanguageDropdown() {
        const dropdown = document.querySelector('.languageDropdown');
        dropdown.classList.toggle('active');
    }

    window.addEventListener('click', function(event) {
        const dropdown = document.querySelector('.languageDropdown');
        if (!dropdown.contains(event.target)) {
            dropdown.classList.remove('active');
        }
    });
</script>

{% endblock %}


{%- block sidebar1 %}
    {{ sidebar() }}
    {%- block sidebarlogo %}{% endblock %}
{% endblock %}


{%- block sidebar2 %}
    {% if display_toc %}
        <div id="show_right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&lt;</span><span>Page contents</span></a></p>
        </div>

        <div id="right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&gt;</span><span>Page contents:</span></a></p>
            <div class="page_toc">
                {{ toc }}
            </div>
        </div>
    {% endif %}
{% endblock %}


{%- block relbar1 %}
{% endblock %}

{%- block relbar2 %}
{% endblock %}

{%- block document %}
    <div style="margin-left: 2vw">
        <p>
            {% if parents|length > 0 %}
                {%- for doc in parents %}
                    <a href="{{ doc.link|e }}">{{ doc.title }}</a> &mdash;
                {%- endfor %}
                {{ title }}
            {% endif %}
        </p>
    </div>
	
	<article>
    	{{ super() }}
    </article>
{% endblock %}



{%- block footer %}
    {{ super() }}

    <p id="theme_credit">{% if theme_show_theme_credit %}Styled using the <a href="https://github.com/piccolo-orm/piccolo_theme">Piccolo Theme</a>{% endif %}</p>
{%- endblock %}
