# Version 16.9

2017年 6月 6日

## 一般の新機能

- \[改行を削除\] コマンドや、改行を含む文字列を、改行を含まない文字列に、すべて置換する動作が大幅に高速化されました。

### 測定結果例

|  | v16.5 | v16.6 | v16.9 | v16.5 との比較 |
| --- | --- | --- | --- | --- |
| 「9\\n」を「a」にすべて置換 | 32.7 秒 | 22.4 秒 | 0.17 秒 | 192 倍に高速化 |
| 上を元に戻す | 73.5 秒 | 29.2 秒 | 27.8 秒 | 2.64 倍に高速化 |
| 改行コードを削除 | 34.8 秒 | 22.4 秒 | 0.12 秒 | 290 倍に高速化 |
| 上を元に戻す | 105.3 秒 | 13.9 秒 | 6.95 秒 | 15.2 倍に高速化 |
| 「0123456789\\n」を「」(空)にすべて置換 | 13.8 秒 | 12.4 秒 | 0.078 秒 | 177 倍に高速化 |
| 上を元に戻す | 7.7 秒 | 0.09 秒 | 0.078 秒 | 99 倍に高速化 |

\\* テスト条件は、 [Version 16.6](v16_6) と同じです。

- 高度なフィルターの各条件に、\[文字列全体に一致する\] チェック ボックスが追加され、これを指定することにより、フィルターの条件が多い場合の動作がさらに高速になりました。

### 測定結果例

|  | v16.8 | v16.9 (\[文字列全体に一致する\] を設定) | 比較 |
| --- | --- | --- | --- |
| 高度なフィルター、大文字小文字を区別しない | 115 秒 | 0.10 秒 | 1,150 倍に高速化 |
| 高度なフィルター、大文字小文字を区別する | 123 秒 | 0.06 秒 | 2,050 倍に高速化 |

\\* 20万行、56.3 MB の CSV ファイル (UTF-8) から、高度なフィルターを使用し、1列目から文字列を検索するフィルター条件 5万個を「前の条件との論理和」で測定。Windows 10 (64-bit) Core i7-4790 16GB RAM

- IPv4 アドレス、IPv6 アドレスがクリックできるようになり、IP アドレスの情報を表示できるようになりました。さらに、IPv4 アドレスでは、マウスをポイントすると、IPv4 アドレスの登録先の国名がツールチップとして表示されるようになりました (この機能を使用するには、別途、ファイルのダウンロードが必要です。下の注意をお読みください。)。さらに、マクロを編集することにより、自由にカスタマイズが可能です。
- 16進数表記のカラー コード、および RGB 表記のカラー コードをクリックして、カラー ピッカーを表示、色を選択してカラー コードを変更できるようになりました。
- URL、メールアドレス、IPv4 アドレス、IPv6 アドレス、引用符で囲まれた文字列、HTML文字参照、Universal Character Names/パーセント エンコーディング、16進数表記のカラー コード、RGB 表記のカラー コードは、「アクティブな文字列」として、従来の動作以外に、マクロ、外部ツール、EmEditor のコマンドなど、より柔軟に自由にカスタマイズできるようになりました。
- 設定のプロパティの \[リンク\] ページでは、どの文字列をアクティブな文字列として有効にするかを指定できるようになりました。また、\[カスタマイズ\] ダイアログ ボックスの \[アクティブな文字列\] ページでは、各アクティブな文字列について、左クリック、左ダブル クリック、中クリック、右クリックの各イベントに動作を割り当てられるようになりました。

## 新しい設定

- [\[高度なフィルター\] ダイアログ ボックス](../dlg/advanced_filter/index) に \[文字列全体に一致する\] チェック ボックスが追加されました。
- 設定のプロパティの [\[リンク\] ページ](../dlg/properties/link/index) に、\[アクティブな文字列\] 一覧が追加されました。
- \[カスタマイズ\] ダイアログ ボックスに [\[アクティブな文字列\] ページ](../dlg/customize/active_string/index) が追加されました。
- \[カスタマイズ\] ダイアログ ボックスの [\[履歴\] ページ](../dlg/customize/history/index) に \[元に戻す/やり直しの履歴に追加情報を追加する\] チェック ボックスが追加されました。
- [\[ファイルを結合\] ウィザード](../dlg/combine_files/combine_wiz_dest) に \[最初の文書を除きすべての文書から最初の行を削除する\] チェック ボックスが追加されました。

## 新しいコマンド

- [列でフィルター](../cmd/edit/filter_column)
- [アクティブな文字列のカスタマイズ](../cmd/tools/customize_active_string)

## プラグイン API の新機能

- [EE\_SHOW\_TIP](../plugin/message/ee_show_tip)、 [EE\_GET\_ACTIVE\_STRING](../plugin/message/ee_get_active_string) メッセージが追加されました。
- [Editor\_ShowTip](../plugin/macro/editor_showtip)、 [Editor\_GetActiveString](../plugin/macro/editor_getactivestring) インライン関数が追加されました。
- [TIP\_INFO](../plugin/structure/tip_info)、 [ACTIVE\_STRING\_INFO](../plugin/structure/active_string_info) 構造体が追加されました。
- EEID\_FILTER\_COLUMN、EEID\_CUSTOMIZE\_ACTIVE\_STRING コマンドが追加されました。

## マクロの新機能

- [Window オブジェクト](../macro/window/index) に [ShowTip メソッド](../macro/window/show_tip) を追加しました。
- [Document オブジェクト](../macro/document/index) に [ActiveString メソッド](../macro/document/active_string) を追加しました。

## 不具合の修正

- \[検索\] ダイアログ ボックスで、\[複数行\] の選択状態が保存されないことがある不具合を修正しました。
- \[ファイルから検索\] に関する特定の不具合を修正しました。
- \[ファイルから置換\] ダイアログ ボックスで、バックアップ フォルダが保存されないことがある不具合を修正しました。

## 注意

IPv4 アドレス上にマウスをポイントさせて、ツールチップで IPv4 アドレスの登録先の国名を表示するには、 [GeoLite2 Country database](https://dev.maxmind.com/geoip/geoip2/geolite2/) をダウンロードしてください。このファイルを解凍し、解凍された CSV ファイルを、次のフォルダに置いてください。

- EmEditor のインストーラーが使用された場合 (レジストリを使用):

%PROGRAMDATA%\\Emurasoft\\EmEditor\\data、つまり_C:\\ProgramData\\Emurasoft\\EmEditor\\data_
- EmEditor ポータブル版が使用された場合 (INI ファイルを使用):

EmEditor インストール先フォルダの 「 _data_」 サブフォルダ、つまり_X:\\...\\EmEditor\\data_

データベースは頻繁に更新されているため、上のファイルを定期的にダウンロードして更新されることを推奨します。

## 謝辞

新しい IPTip.jsee マクロは [MaxMind](http://www.maxmind.com) によって作成された GeoLite データを使用しています。

### 

#### copyright © 2003-2023 by Emurasoft, Inc.
