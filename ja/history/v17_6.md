# Version 17.6

2018年 4月 18日

## 一般の新機能

- 巨大ファイルを開いた場合の \[重複行の削除\] コマンドの動作を大幅に高速化しました。
- 並べ替えコマンドを高速化しました。
- DirectWrite をサポートし、高品質のサブ ピクセル ClearType テキスト レンダリングを実現しました。絵文字などのカラー フォントに対応しました (カラー フォントは Windows 8.1 以上のみ)。EmEditor でファイルを開いた後、\[カスタマイズ\] ダイアログ ボックスの \[テキスト レンダリング\] ページで設定を変更すると、変更を確定する前に EmEditor ウィンドウでプレビュー表示されます。DirectWrite は、既定ではオフになっています。
- 文字コード値のダイアログ ウィンドウは Unicode 名を含むようになりました。
- Markdown 用の設定を追加しました。
- \[フラッシュ フィル\] コマンドを改善しました。

### テスト結果

|  | v17.5 | v17.6 | 比較 |
| --- | --- | --- | --- |
| 重複行の削除 | 392分31秒 | 116分10秒 | 3.38倍に高速化 |
| 並べ替え (既定オプション) | 93.5 秒 | 74.4 秒 | 20.4 % 高速化 |
| 並べ替え (高速バイナリ比較) | 74.3 秒 | 46.5 秒 | 37.4 % 高速化 |

\\* 重複行の削除: 32.2 GB、1,360,000,000 行、Unicode (UTF-16LE) ランダム データ、並べ替え: 538 MB、10,000,000 行、ASCII ランダム データ、すべて: Windows 10 (64-bit)、Core i7-8700K、32GB RAM。

## 新しい設定

- \[カスタマイズ\] ダイアログ ボックスに [\[テキスト レンダリング\] ページ](../dlg/customize/text_rendering/index) を追加しました。
- \[CSVの結合\] ウィンドウに \[ヘディングを無視する\] チェック ボックスを追加しました。これがチェックされていると、結合前のヘディングが結合後も保存されます。
- \[重複行の削除/ブックマーク\] ダイアログ ボックスに \[大文字と小文字を区別しない\] チェック ボックスを追加しました。
- \[ツール バー\] ダイアログ ボックスに \[サイズ\] スライダーを追加し、\[検索\] ツール バーと \[フィルター\] ツール バーのドロップ ダウン リスト ボックスのフォント サイズを調節できるようになりました。
- 設定のプロパティの \[表示\] ページの \[行間隔\] テキスト ボックスに負の値 (-2 まで) を入力できるようになりました。

## プラグイン API の新機能

- [EE\_INFO メッセージ](../plugin/message/ee_info) に、EI\_GET\_NEWLINE\_CODE フラグを追加しました。
- [MANAGE\_DUPLICATES\_INFO 構造体](../plugin/structure/manage_duplicates_info) に、MANAGE\_DUPLICATES\_INCLUDE\_ALL とMANAGE\_DUPLICATES\_IGNORE\_CASE フラグを追加しました。
- [EE\_IS\_CHAR\_HALF\_OR\_FULL](../plugin/message/ee_is_char_half_or_full) メッセージと [Editor\_IsCharHalfOrFull](../plugin/macro/editor_ischarhalforfull) インライン関数を改善しました。

## マクロの新機能

- Document オブジェクトに [NewlineCode プロパティ](../macro/document/newline_code) を追加しました。
- [DeleteDuplicates メソッド](../macro/document/delete_duplicates) に、eeIncludeAll と eeSortIgnoreCase フラグを追加しました。

## 不具合の修正

- 結合文字上のカーソル移動の動作を改善しました。
- 列数がそろっていない CSV 文書を開いている場合、フィルター ツール バーの列ドロップ ダウン リストをクリックすると異常終了することがある不具合を修正しました。
- 「\\b」を含む正規表現が正しく動作しない不具合を修正しました。
- 巨大ファイル コントローラーの \[開いた部分を保存\] ボタンに関する不具合を修正しました。
- \[重複行の削除/ブックマーク(高度)\] コマンドで、\[隣の行のみ比較する\] オプションが有効で、CSV文書の1列のみを選択すると、正しく動作しないことがある不具合を修正しました。
