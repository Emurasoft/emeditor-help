# Version 15.5

2015年 10月 27日

## 一般の新機能

- EmEditor を新規作成で起動時、常にスタート ウィンドウを表示するようにしました (設定で非表示にすることも可能)。スタート ウィンドウから、マウスのクリック、または↑、↓キーと Enter キーだけで前回終了時のワークスペース (既定のワークスペース)、最近使ったファイル、最近使ったフォルダをすぐに選択することができます。設定により、最近のワークスペースも表示することができます。スタート ウィンドウは、軽量、高速に表示するように設計されており、以前の動作を妨げることはありません。スタート ウィンドウを表示中でも、キーボード フォーカスは最初はエディタ上にあり、文字を入力したり、コマンドを選択することにより、スタート ウィンドウは非表示になります。また、新規作成の後、↓キーを押すと、スタート ウィンドウが表示されます。
- マクロの新しい ExecutePlugin メソッドによりマクロからプラグインの機能を呼び出せるようになりました。これにより、例えば、スニペット プラグインが動作中でなくても、スニペットの機能を一時的に実行することができるようになりました。以下の「マクロからプラグインを呼び出す例」を参照してください。
- 文字列選択時、従来は、CSV のセパレータを示す縦線、罫線は非表示になっていましたが、これらを表示するように変更しました。現在のところ、これについての設定はありませんが、設定が必要な場合にはお知らせください。
- ワークスペースに、区切り状態、ヘディングの状態、区切り位置を含めるようになりました。今後も新しい設定を含める可能性があります。その場合には、ベータ版で保存したワークスペースが使えなくなる可能性があります。重要なワークスペースは本ベータ版を実行する前にバックアップを取っておいてください。
- フィルター ツール バーのフィルター文字列の長さの制限は、10,000文字まで緩和されました。
- \[文書を複数ファイルに分割\] ウィザードのヘッダーとフッターの文字列の長さの制限は、10,000文字まで緩和されました。
- \[列を抽出\]、\[CSVの結合\]、\[複数列で並べ替え\] ダイアログ ボックスの一覧で、複数項目を選択して移動できるようになりました。
- EmEditor をインストール後、最初に起動時、\[更新チェッカーのカスタマイズ\] ダイアログを表示するのを取りやめて、その代わりに「自動更新チェックを有効にしますか?」というコマンド リンク付きのダイアログ ボックスを表示するようにしました。
- ポータブル版または更新チェックの機能を外してインストールされている場合、\[更新のチェック\] コマンドをグレー表示するのを取りやめて常に選択可能状態にし、選択すると「ポータブル版は更新のチェックを行うことができません。」などの表示を行うようにしました。
- 既定で、3 つのマクロ (「合計」、「XML の整合性チェック」、「HTML/XML タグで囲む」) が、インストール先の Macros サブ フォルダにインストールされ、マイ マクロの一覧に追加されるようになりました。後からマイ マクロから削除することは可能です。一度削除すれば、次回よりマイ マクロに追加されることはありません。
- アウトプット バーで右クリックして表示されるメニューに \[ウィンドウの右端で折り返し\] コマンドを追加しました。従来は、アウトプット バーで1行が長い行は、ウィンドウの右端で折り返されていましたが、このチェックを外すと、ウィンドウの右端では折り返さず、約1,024文字で折り返すようになります。
- Ctrl+F12 で EmEditor ウィンドウの分割を開始した後、Home、End、Page Up、または Page Down キーを押して分割位置をウィンドウの端に移動することができるようになりました。

## マクロからプラグインを呼び出す例

**スニペット プラグインを呼び出し、選択文字列を HTML/XML のタグで囲む**

editor.ExecutePlugin("Snippets.dll", eePluginUserMessage, 0, "<${1:p}>${2:${SelText}}</$1>$0" );

**プロジェクト プラグインを呼び出し、指定するソリューション ファイルを開く**

editor.ExecutePlugin("Projects.dll", eePluginUserMessage, 0, "E:\\\Test\\\Test.eesln" );

**検索プラグインを呼び出し、指定する文字列を検索して検索結果一覧を表示する**

editor.ExecutePlugin("Search.dll", eePluginUserMessage, eeFindReplaceCase \| eeFindReplaceRegExp, "Test" );

**指定するパスに存在するプラグインを単に実行する**

editor.ExecutePlugin("E:\\dir\\plugin.dll", eePluginExecuteCommand \| eePluginAbsolutePath );

**指定するパスに存在するプラグインのステータスを調べる**

status = editor.ExecutePlugin("E:\\dir\\plugin.dll", eePluginQueryStatus \| eePluginAbsolutePath );

## 新しい設定

- \[カスタマイズ\] ダイアログ ボックスの \[ウィンドウ\] ページに、\[スタート ウィンドウ\] ボタンが追加され、 [\[スタート ウィンドウのカスタマイズ\] ダイアログ](../dlg/customize_start/index) が追加されました。
- \[カスタマイズ\] ダイアログ ボックスの \[CSV\] ページに、\[ダブル クリックでセルを選択\] チェック ボックスが追加されました。
- [\[トレイ アイコンの設定\] ダイアログ ボックス](../dlg/tray/index) で、\[ショートカット キー\] テキスト ボックスに Ctrl + Shift、Alt + Shift キーの組み合わせも入力できるようになりました。
- HKEY\_CURRENT\_USER\\SOFTWARE\\EmSoft\\EmEditor v3\\Common キーの中に、以下の REG\_DWORD 値を設定することにより、ドロップダウン リストの幅を変更することができるようになりました。

**CWFind**: 検索ツール バーの検索ドロップダウン リスト 既定値: 0xc8 (200)

**CWReplace**: 検索ツール バーの置換ドロップダウン リスト 既定値: 0xc8 (200)

**CWFilter**: フィルター ツール バーの検索ドロップダウン リスト 既定値: 0xc8 (200)

**CWColumn**: フィルター ツール バーの列ドロップダウン リスト 既定値: 0x7d (125)
- HKEY\_CURRENT\_USER\\SOFTWARE\\EmSoft\\EmEditor v3\\Common キーの中に、以下の REG\_DWORD 値を設定することにより、 [\[保存時の詳細\] ダイアログ ボックス](../dlg/properties/file/save_details/index) で \[自動的に無題の文書に名前を付ける\] チェック ボックスがチェックされている時、ファイル名の最大の長さを設定することができるようになりました。

**MaxNameUntitled**: ファイル名の最後の NULL 文字を含む最大の長さ 既定値: 0x50 (80)

## 新コマンド

- **[スタート ウィンドウ](../cmd/tools/start_window)**
- **[ウィンドウの右端で折り返し (アウトプット バー)](../cmd/view/toggle_output_wrap)**

## プラグインの新機能

- \[スニペット\] プラグインがユーザー メッセージに対応しました。スニペットが実行中でなくても、マクロから一時的にスニペットの文字列を指定して呼び出せるようになりました。
- \[プロジェクト\] プラグインがユーザー メッセージに対応しました。マクロから指定するソリューション ファイルを開けるようになりました。
- \[検索\] プラグインがユーザー メッセージに対応しました。マクロから指定する文字列で検索して一覧に検索結果を表示できるようになりました。

## プラグイン API の新機能

- [EE\_EXEC\_PLUGIN メッセージ](../plugin/message/ee_exec_plugin)、 [Editor\_ExecPlugin インライン関数](../plugin/macro/editor_execplugin)、 [EXEC\_PLUGIN\_INFO 構造体](../plugin/structure/exec_plugin_info) が追加されました。
- EI\_GET\_COMBINE\_HISTORY パラメータが [EE\_INFO メッセージ](../plugin/message/ee_info) ( [Editor\_Info インライン関数](../plugin/macro/editor_info)) に追加されました。
- [EP\_USER\_MSG メッセージ](../plugin/plugin_message/ep_user_msg) がプラグインへのメッセージに追加されました。

## マクロの新機能

- Window オブジェクトに [CombineHistory プロパティ](../macro/window/combine_history) が追加されました。
- [ExecutePlugin メソッド](../macro/editor/editor_executeplugin) が Editor オブジェクトに追加され、eePluginExecuteCommand、eePluginUserMessage、eePluginQueryStatus、eePluginAbsolutePath フラグが追加されました。
- [LangID プロパティ](../macro/editor/langid) が Editor オブジェクトに追加されました。

### copyright © 2003-2023 by Emurasoft, Inc.
