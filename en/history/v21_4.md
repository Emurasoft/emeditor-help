# Version 21.4

December 22, 2021

## New General Features

- EnabledAutomatic Updates on theFree version (previously, only theProfessional version supportedAutomatic Updates).
- Enabled the ability to disableNotifications and/or the NotificationBalloon tip on theFree version (previously, only theProfessional version allowed disablingNotifications and/or the NotificationBalloon tip).
- UsedMeiryo UI for Japanese,Malgun Gothic for Korean, andSegoe UI for other languages as default dialog box fonts (customizable in theWindow page of theCustomize dialog box).
- Separated theCSV/Sort toolbar into theCSV toolbar andSort toolbar. TheSort toolbar is one of basic toolbars and customizable.
- Added theTranspose,Pivot Table andUnpivot buttons to theSort toolbar.
- The new version allows recording some selections with the mouse to macros.
- Improved the speed ofCombine Columns,Split Columns, andEncode/Decode Selection commands while columns are selected in the CSV mode.

### Test results:

|  | v21.3 | v21.4 | Comparison |
| --- | --- | --- | --- |
| Combine Columns\*1 | 13.5 seconds | 1.23 seconds | 11.0 times faster |
| Split Column\*2 | 5.56 seconds | 2.66 seconds | 2.09 times faster |

\*1 Select all 16 columns, Concatenate, String to insert: ";".

\*2 Use a file saved after \*1, Split all into columns, Separator: ";".

All: 1.99 GB, 15.9 million lines, random CSV data. Default options except Always Discard Lengthy Undo Information to Accelerate on, 16 threads, Windows 11, Core i9-11900K, 64GB RAM, 2TB SSD.

## New Options

- Added theLocale-dependent Uppercase/Lowercase check box to the [Edit page](../dlg/customize/edit/index) of theCustomize dialog box.
- Added theRun macros asynchronously by default check box to the [Options page](../dlg/macro_customize/options/index) of theCustomize Macros dialog box.
- Added theRemove empty strings,Remove duplicate strings, andSort strings check boxes, andHow to Sort list box to the [Combine Columns dialog box](../dlg/combine_columns/index).
- Added theDialog box font drop-down list box to the [Window page](../dlg/customize/window/index) of theCustomize dialog box.
- TheNew button in the [Toolbars dialog box](../dlg/toolbars/index) became a split button. Clicking â–¼ allows you to reset a new toolbar as the Basic or Sort toolbar.
- Added the[Pivot Table](../dlg/pivot_table/index) and[Unpivot](../dlg/unpivot/index) dialog boxes.

## New Commands

- [Transpose](../cmd/edit/transpose)
- [Pivot Table](../cmd/edit/pivot_table)
- [Unpivot](../cmd/edit/unpivot)

## Plug-in New Features

- Added [EE\_PIVOT\_TABLE message](../plugin/message/ee_pivot_table), [PIVOT\_TABLE\_INFO structure](../plugin/structure/pivot_table_info), and [Editor\_PivotTable inline function](../plugin/macro/editor_pivottable).
- Added [EE\_UNPIVOT message](../plugin/message/ee_unpivot), [UNPIVOT\_INFO structure](../plugin/structure/unpivot_info), and [Editor\_Unpivot inline function](../plugin/macro/editor_unpivot).
- AddedEI\_GET\_SPLIT command to the [EE\_INFO message](../plugin/message/ee_info).
- Added theFLAG\_MAKE\_LOWER\_L,FLAG\_MAKE\_UPPER\_L, andFLAG\_CAPITALIZE\_L flags to the [EE\_CONVERT message](../plugin/message/ee_convert) and [Editor\_Convert inline function](../plugin/macro/editor_convert).
- Added thenCombineFlags andpszLocale parameters to the [Editor\_EditColumn inline function](../plugin/macro/editor_editcolumn). Added thenCombineFlags andpszLocale fields to the [EDIT\_COLUMN\_INFO structure](../plugin/structure/edit_column_info).

## Macro New Features

- Added the [PivotTable method](../macro/document/pivot_table) and [Unpivot method](../macro/document/unpivot) to theDocument object.
- Added the _strSortType_, _nCombineFlags_, and _strLocale_ parameters to the [CombineColumns method](../macro/document/combinecolumns) of theDocument object.
